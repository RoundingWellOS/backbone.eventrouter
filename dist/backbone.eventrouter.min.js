/**
 * backbone.eventrouter - A highly opinionated, simplistic Backbone.Router coupled with a Backbone.Radio.Channel
 * @version v0.3.0
 * @link https://github.com/RoundingWellOS/backbone.eventrouter
 * @license MIT
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("underscore"),require("backbone"),require("backbone.radio")):"function"==typeof define&&define.amd?define(["underscore","backbone","backbone.radio"],e):(t.Backbone=t.Backbone||{},t.Backbone.EventRouter=e(t._,t.Backbone,t.Radio))}(this,function(t,e,r){"use strict";t="default"in t?t.default:t,e="default"in e?e.default:e;var i=e.EventRouter=e.Router.extend({constructor:function(r){r=t.extend({},r),e.Router.apply(this,arguments),t.extend(this,t.pick(r,["channelName","routeTriggers"])),this._ch=e.Radio.channel(t.result(this,"channelName")),this._initRoutes(),this.listenTo(this._ch,"all",this.navigateFromEvent)},channelName:"event-router",getChannel:function(){return this._ch},_initRoutes:function(){this._routeTriggers=t.result(this,"routeTriggers")||{},t.each(this._routeTriggers,this._addRouteTrigger,this)},_addRouteTrigger:function(e,r){e=t.isArray(e)?e:[e],t.each(e,function(e){this.route(e,r,t.bind(this._ch.trigger,this._ch,r))},this)},addRouteTrigger:function(t,e){return this._routeTriggers[e]=t,this._addRouteTrigger(t,e),this},route:function(r,i,n){t.isFunction(i)&&(n=i,i=""),n||(n=this[i]);var o=t.bind(function(){var e=t.drop(arguments,0);this.trigger("before:route",i,e),this.trigger.apply(this,["before:route:"+i].concat(e)),this._storeRouteTrigger([i].concat(e)),n.apply(this,e),this._clearRouteTrigger()},this);return e.Router.prototype.route.call(this,r,i,o)},_storeRouteTrigger:function(t){this._routeArgs=this._routeArgs||[],this._routeArgs.push(t)},_getCurrentRouteTrigger:function(){return t.last(this._routeArgs)||[]},_clearRouteTrigger:function(){this._routeArgs.pop()},_isTriggeredFromRoute:function(){var e=this._getCurrentRouteTrigger();return arguments.length===e.length&&arguments.length===t.union(arguments,this.currentRoute).length},navigateFromEvent:function(e){var r=this.getDefaultRoute(e);if(!r){var i=t.drop(arguments,0);return this.trigger.apply(this,["noMatch"].concat(i)),this}if(this._isTriggeredFromRoute.apply(this,arguments))return this;var n=t.drop(arguments,1),o=this.translateRoute(r,n);return this.navigate(o,{trigger:!1})},getDefaultRoute:function(e){var r=this._routeTriggers[e];return t.isArray(r)?r[0]:r},_replaceParam:function(t,e){var r=/(\(\?)?:\w+/;return t.replace(r,e)},translateRoute:function(e,r){return t.reduce(r,this._replaceParam,e)}});return i});
//# sourceMappingURL=backbone.eventrouter.min.js.map
